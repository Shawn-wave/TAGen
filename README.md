# TAGen:

TAGen (TAM+GenAug) is a project that combines two model:

1. TAM (Track-Anything): For tracking video object and segmentation 
2. GenAug (Generation Augmentation): For image augmentation and dataset creation

This project aims to create diverse datasets for imitate learning tasks by leveraging object tracking, and image augmentation techniques.

## Components

### 1. TAM (Track-Anything)

TAM is responsible for:
- Converting teleoperation data to video
- Generating masks for objects of interest
- Merging mask and teleoperation data

### 2. GenAug (Generation Augmentation)

GenAug handles:
- Generating background and table (desired mask) images based on prompts
- Compositing augmented images using the generated backgrounds and tables

## Prerequisites

- Conda environments:
  - TAM
  - GenAug

## Installation

1. TAM environment:
   ```
   cd TAGen/Track-Anything_main
   conda create -n TAM python=3.10.12
   conda activate TAM
   pip install -r requirements_TAM.txt
   ```


2. Gen Aug environment:
   ```
   cd TAGen/genaug_main
   conda create -n GenAug python=3.10.12
   conda activate GenAug
   pip install -r requirements_TAM.txt
   ```

   - torch and torchvision versions are down for your environment


## Usage

### 1. TAM: Data Collection and Mask Generation

1. Activate the TAM environment:
   ```
   conda activate TAM
   ```


2. Convert teleoperation data to video:
   ```
   cd TAGen/process_data
   python rgb_h52vid.py
   ```


3. Generate masks:
   ```
   cd TAGen/Track-Anything_main
   python main.py
   ```

   - Select the desired mask by clicking on the video input
   - You can rename masks in the TAM interface
   - If the mask does not exist in that frame, it can be masked again from that frame


4. Merge mask and teleoperation data:
   ```
   cd TAGen/process_data
   python merge.py
   ```


### 2. GenAug: Image Augmentation

1. Activate the GenAug environment:
   ```
   conda activate GenAug
   ```


2. Generate iterested masking area images:
   ```
   cd TAGen/genaug_main
   python main.py --gen
   ```

   - You will be prompted to enter desired prompts for background and table image generation


3. Composite augmented images:
   ```
   python main.py --com
   ```

   - Merge files and images generated by gen are randomly combined

## Directory Structure

- `aug_raw/`: Generate desired mask area images by --gen
- `augmented_output/`: 
  - `h5/`: Augmented H5 files
  - `frame/`: Augmented image frames
- `mask/`: Mask data generated by TAM
- `merge/`: Merged mask and teleoperation data by merge.py
- `teleop/`: Raw teleoperation data
- `video/`: Converted teleoperation videos by rgb_h52vid.py 

## Workflow

1. Collect teleoperation data
2. Use TAM to:
   - Convert teleoperation data to video
   - Generate masks for objects of interest
   - Merge mask and teleoperation data
3. Use GenAug to:
   - Generate desired mask area images based on prompts
   - Composite augmented images using generated image